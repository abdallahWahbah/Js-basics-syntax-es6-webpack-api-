<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>
<body>
    <h1>Asynchronous JavaScript</h1>
    <script>
        // Lecture1
        
        // const second = () =>
        // {
        //     setTimeout(()=> {
        //         console.log("Async hey there")
        //     }, 2000)
        // }
        // const first = ()=>
        // {
        //     console.log("hey there")
        //     second()
        //     console.log("the end")
        // }
        // first();
        



        // Lecture4
        
        // getRecipe = ()=>
        // {
        //     setTimeout(()=>
        //     {
        //         const recipeId = [23, 94, 99, 109]
        //         console.log(recipeId);

        //         setTimeout((id)=>
        //         {
        //             const recipe = 
        //             {
        //                 title : "fresh tomato",
        //                 publisher : "jonas"
        //             }
        //             console.log(`${id}: ${recipe.title}`)

        //             setTimeout((publisher) =>
        //             {
        //                 const recipe2 = {title:"italian", publisher :"jonas"}
        //                 console.log(recipe2);
        //             }, 1500, recipe.publisher)
        //         }, 1500, recipeId[2]) // the 3rd param is the param in the setTimeOut func

        //     }, 3000);
        // }
        // getRecipe();
        



        // Lecture5
        
        // const getIDs = new Promise((resolve, reject) =>
        // {
        //     setTimeout(()=>
        //     {
        //         resolve ([23, 94, 99, 109]);  // return the array if the promise has secceded
        //         // reject ([1, 2, 3, 4]);  // return the array if the promise has failed
        //     }, 1500)
        // })

        // const getRecipe = (recId =>
        // {
        //     return new Promise((resolve, reject) =>
        //     {
        //         setTimeout(ID =>
        //         {
        //             const recipe = 
        //             {
        //                 title : "Fresh tomato",
        //                 publisher : "Jonas"
        //             }
        //             resolve(`${ID}: ${recipe.title}`)
        //         }, 1500, recId)
        //     })
        // })

        // const getRelated = (publisher =>
        // {
        //     return  new Promise((resolve, reject) =>
        //     {
        //         setTimeout(pub =>
        //         {
        //             const recipe = {title:"Italiano", publisher:"jonas"}
        //             resolve(`${pub}:${recipe.title} `)
        //         }, 1500, publisher)
        //     })
        // })

        // getIDs.
        // then( IDs =>        // IDs :  result(return) from the resolve when the promise seccedd (then)
        // {
        //     console.log(IDs)
        //     return getRecipe (IDs[2])
        // })
        // .then(recipe =>
        // {
        //     console.log(recipe)
        //     return getRelated("jonas ahmed")
        // })
        // .then(related =>
        // {
        //     console.log(related)
        // })
        // .catch (IDs =>          // IDs: return from the reject when the promise fails
        // {
        //     console.log(IDs)
        //     console.log("ERROR !!!!!!")
        // })
        



        // Lecture6
        // async/await is designed to consume promises not to make them, if you wanted to make them, look at the previous lecture
        
        // async function getRecipesAW()
        // {
        //     const IDs = await getIDs;
        //     console.log(IDs);
        //     const recipe = await getRecipe(IDs[2]);
        //     console.log(recipe);
        //     const related = await getRelated("jonas ahmed");
        //     console.log(related);

        //     return recipe ; // async always return a promise object, so you can concern the recipe object as a promise
        // }
        // getRecipesAW().then(result => console.log(`${result} is the best ever `));
        



        // fetch returns a promise object

        // Lecture8, 9 >>>>>>>>>>.. the server is not good, watch this video
        // https://www.youtube.com/watch?v=GXrDEA3SIOQ

        // in lecture 8 i had a terrible error which he talked about "CORS", but it hadn't been solved with crossorigin.me
        // so i had to another cors site (https://cors-anywhere.herokuapp.com/)


        // Lecture8
        
        // function getWeather(woeid) // where on earth id
        // {
        //     fetch(`https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/${woeid}/`)
        //     .then(result => {
        //         //console.log(result); // stream, we have to convert it
        //         return result.json(); // returns a promise
        //     })
        //     .then(data => {
        //         console.log(data);
        //         const today = data.consolidated_weather[0];
        //         console.log(`Weather in ${data.title} is between ${today.min_temp}, ${today.max_temp} `);
        //     })
        //     .catch(error => console.log(error));
        // }
        // getWeather(2487956);
        // getWeather(44418);
        





        // Lecture9
        // convert the fetch to async await
        async function getWeatherAW(woeid){
            try
            {
                const result = await fetch(`https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/${woeid}/`);
                const data = await result.json();
                // console.log(data);        

                const today = data.consolidated_weather[0];
                console.log(`Weather in ${data.title} is between ${today.min_temp}, ${today.max_temp} `);

                return data; // return a promise

            }
            catch(e)
            {
                console.log(e);
            }
        }
        getWeatherAW(2487956);

        // let x ;
        // getWeatherAW(44418).then(data =>
        // {
        //     x = data;
        //     console.log(x);
        //     document.querySelector("h1").textContent = x;
        // });

        // غالبا الكود الاخير مش شغال لانهم حاطين عدد معين من الدخول علي الموقع

    
    
        
    
    
    </script>
</body>
</html>